<!DOCTYPE html>
<html lang="zh-CN">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Â§™Á©∫ÊàòÊéíË°åÊ¶ú</title>
<style>
  @import url('https://fonts.googleapis.com/css2?family=Orbitron:wght@500&display=swap');

  body, html {
    margin: 0; padding: 0; height: 100%;
    overflow: hidden;
    font-family: 'Orbitron', sans-serif;
    color: white;
    user-select: none;
    background: black;
  }

  #spaceCanvas {
    position: fixed;
    top: 0; left: 0;
    width: 100%; height: 100%;
    z-index: -1;
    background: radial-gradient(circle at center, #0b0f2a, #000011 80%);
  }

  h1 {
    text-align: center;
    padding-top: 30px;
    font-size: 3.5em;
    letter-spacing: 0.15em;
    color: #000000;
    text-shadow:
      0 0 10px #ffffff,
      0 0 20px #a3c1ff,
      0 0 30px #6f92ff,
      0 0 40px #6f92ff,
      0 0 60px #4169e1,
      0 0 80px #1e40ff;
  }

  .leaderboard {
    max-width: 650px;
    margin: 40px auto 20px;
    background: rgba(10, 10, 30, 0.85);
    border-radius: 20px;
    box-shadow:
      0 0 30px 8px rgba(30, 144, 255, 0.7),
      inset 0 0 20px #000020;
    padding: 25px 40px;
  }

  .player {
    display: flex;
    align-items: center;
    margin: 12px 0;
    transition: transform 0.3s ease;
    color: #cce0ff;
  }
  .player:hover {
    transform: scale(1.05);
    color: #ffffff;
    text-shadow:
      0 0 6px #78aaff,
      0 0 12px #78aaff;
  }

  .rank-number {
    display: inline-block;
    width: 2em;
    color: #88bbff;
    font-weight: bold;
    margin-right: 10px;
  }

  .top1 {
    font-size: 2.5em;
    color: #ffd700;
    text-shadow:
      0 0 15px #fff,
      0 0 40px #ffd700,
      0 0 60px #ffdd00;
    font-weight: 900;
  }
  .top2 {
    font-size: 2em;
    color: #c0c0c0;
    text-shadow:
      0 0 12px #eee,
      0 0 35px #c0c0c0;
    font-weight: 800;
  }
  .top3 {
    font-size: 1.8em;
    color: #cd7f32;
    text-shadow:
      0 0 12px #b3722a,
      0 0 30px #cd7f32;
    font-weight: 700;
  }
  .normal {
    font-size: 1.2em;
    color: #aaccee;
  }

  .crown {
    width: 38px;
    margin-right: 15px;
    animation: float 2.5s ease-in-out infinite;
  }

  .crown.top1 { filter: drop-shadow(0 0 10px gold); }
  .crown.top2 { filter: drop-shadow(0 0 10px silver); }
  .crown.top3 { filter: drop-shadow(0 0 10px #cd7f32); }

  @keyframes float {
    0%, 100% { transform: translateY(0); }
    50% { transform: translateY(-8px); }
  }

  /* ËøîÂõûÊåâÈíÆÊ†∑Âºè */
  #backBtn {
    background: linear-gradient(145deg, #00bfff, #1e90ff);
    border: none;
    color: white;
    font-size: 1.5em;
    padding: 12px 32px;
    border-radius: 50px;
    cursor: pointer;
    box-shadow:
      0 0 10px #00bfff,
      0 0 20px #1e90ff,
      inset 0 0 10px rgba(255, 255, 255, 0.2);
    transition: all 0.3s ease;
    font-family: 'Orbitron', sans-serif;
  }
  #backBtn:hover {
    transform: scale(1.08);
  }
</style>
</head>
<body>

<canvas id="spaceCanvas"></canvas>

<h1>üåå Â∞èÊ∏∏ÊàèÊéíË°åÊ¶ú</h1>
<div class="leaderboard" id="leaderboard">ËΩΩÂÖ•‰∏≠...</div>

<!-- ËøîÂõûÈ¶ñÈ°µÊåâÈíÆ -->
<div style="text-align: center; margin-bottom: 40px;">
  <button id="backBtn" onclick="goHome()">ËøîÂõûÈ¶ñÈ°µ</button>
</div>

<script>
const canvas = document.getElementById('spaceCanvas');
const ctx = canvas.getContext('2d');
let width, height;
let stars = [];
let nebulae = [];
let shootingStars = [];

function randomRange(min, max) {
  return Math.random() * (max - min) + min;
}

function initCanvas() {
  width = window.innerWidth;
  height = window.innerHeight;
  canvas.width = width;
  canvas.height = height;

  stars = [];
  for(let i=0; i<300; i++) {
    stars.push({
      x: Math.random() * width,
      y: Math.random() * height,
      size: Math.random() * 1.5 + 0.3,
      alpha: Math.random(),
      twinkleSpeed: 0.005 + Math.random() * 0.02,
      twinkleDir: Math.random() > 0.5 ? 1 : -1
    });
  }

  nebulae = [];
  for(let i=0; i<5; i++) {
    nebulae.push({
      x: Math.random() * width,
      y: Math.random() * height * 0.7,
      radius: randomRange(100, 300),
      color: `hsla(${randomRange(180, 240)}, 70%, 60%, 0.15)`
    });
  }

  shootingStars = [];
}

function drawStars() {
  stars.forEach(star => {
    star.alpha += star.twinkleSpeed * star.twinkleDir;
    if(star.alpha <= 0 || star.alpha >= 1) {
      star.twinkleDir *= -1;
      star.alpha = Math.max(0, Math.min(1, star.alpha));
    }
    ctx.fillStyle = `rgba(255, 255, 255, ${star.alpha})`;
    ctx.beginPath();
    ctx.arc(star.x, star.y, star.size, 0, Math.PI * 2);
    ctx.fill();
  });
}

function drawNebulae() {
  nebulae.forEach(n => {
    let gradient = ctx.createRadialGradient(n.x, n.y, 0, n.x, n.y, n.radius);
    gradient.addColorStop(0, n.color);
    gradient.addColorStop(1, 'transparent');
    ctx.fillStyle = gradient;
    ctx.beginPath();
    ctx.arc(n.x, n.y, n.radius, 0, Math.PI * 2);
    ctx.fill();
  });
}

function addShootingStar() {
  shootingStars.push({
    x: Math.random() * width,
    y: randomRange(0, height * 0.5),
    length: randomRange(80, 150),
    speed: randomRange(6, 10),
    angle: Math.PI / 4,
    life: 0,
    maxLife: randomRange(30, 50)
  });
}

function drawShootingStars() {
  for(let i = shootingStars.length - 1; i >= 0; i--) {
    let star = shootingStars[i];
    star.x += star.speed * Math.cos(star.angle);
    star.y += star.speed * Math.sin(star.angle);
    star.life++;

    let alpha = 1 - star.life / star.maxLife;

    ctx.strokeStyle = `rgba(255, 255, 255, ${alpha})`;
    ctx.lineWidth = 2;
    ctx.beginPath();
    ctx.moveTo(star.x, star.y);
    ctx.lineTo(star.x - star.length * Math.cos(star.angle), star.y - star.length * Math.sin(star.angle));
    ctx.stroke();

    if(star.life > star.maxLife) {
      shootingStars.splice(i, 1);
    }
  }
}

let shootingStarTimer = 0;
function animate() {
  ctx.clearRect(0, 0, width, height);
  drawNebulae();
  drawStars();
  drawShootingStars();
  shootingStarTimer++;
  if (shootingStarTimer > 100) {
    if (Math.random() < 0.3) addShootingStar();
    shootingStarTimer = 0;
  }
  requestAnimationFrame(animate);
}

window.addEventListener('resize', initCanvas);
initCanvas();
animate();

// Ë∑≥ËΩ¨È¶ñÈ°µÂáΩÊï∞
function goHome() {
  window.location.href = "index.html";
}

// ÊéíË°åÊ¶úÈÄªËæë
const currentMonth = new Date().getMonth();
const storedMonth = parseInt(localStorage.getItem("rankingMonth"));
if (isNaN(storedMonth) || storedMonth !== currentMonth) {
  localStorage.setItem("spaceWarRankings", "[]");
  localStorage.setItem("rankingMonth", currentMonth.toString());
}

let rankings = JSON.parse(localStorage.getItem("spaceWarRankings")) || [];
rankings.sort((a,b) => b.score - a.score);

const leaderboard = document.getElementById('leaderboard');
if (rankings.length === 0) {
  leaderboard.innerHTML = "<p style='font-size:1.3em; color:#888'>ÊöÇÊó†ËÆ∞ÂΩïÔºåËµ∂Âø´ÂéªÁé©Ê∏∏ÊàèÂêßÔºÅ</p>";
} else {
  leaderboard.innerHTML = "";
  rankings.slice(0, 50).forEach((entry, i) => {
    let div = document.createElement('div');
    div.classList.add('player');

    let rankSpan = document.createElement('span');
    rankSpan.className = 'rank-number';
    rankSpan.textContent = `${i + 1}.`;
    div.appendChild(rankSpan);

    let crownImg = null;
    if (i === 0) {
      div.classList.add('top1');
      crownImg = document.createElement('img');
      crownImg.src = "https://cdn.jsdelivr.net/gh/twitter/twemoji/assets/72x72/1f451.png";
      crownImg.classList.add('crown', 'top1');
    } else if (i === 1) {
      div.classList.add('top2');
      crownImg = document.createElement('img');
      crownImg.src = "https://cdn.jsdelivr.net/gh/twitter/twemoji/assets/72x72/1f948.png";
      crownImg.classList.add('crown', 'top2');
    } else if (i === 2) {
      div.classList.add('top3');
      crownImg = document.createElement('img');
      crownImg.src = "https://cdn.jsdelivr.net/gh/twitter/twemoji/assets/72x72/1f949.png";
      crownImg.classList.add('crown', 'top3');
    } else {
      div.classList.add('normal');
    }

    if (crownImg) div.appendChild(crownImg);
    let text = document.createTextNode(`${entry.name} ‚Äî ${entry.score}`);
    div.appendChild(text);
    leaderboard.appendChild(div);
  });
}
</script>

</body>
</html>
